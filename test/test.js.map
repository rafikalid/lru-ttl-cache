{"version":3,"sources":["test.ts"],"names":[],"mappings":"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","file":"test.js","sourcesContent":["import {describe, it} from 'mocha';\r\nimport Assert from 'assert'\r\nimport LRU_TTL from '..';\r\n\r\ndescribe('Cache Test', function(){\r\n    var cache: LRU_TTL<any, any>;\r\n    this.beforeAll(function(){\r\n        cache= new LRU_TTL({\r\n            ttl: 20000,\r\n            max: 4\r\n        });\r\n    });\r\n    // this.beforeEach(function(){\r\n    //     cache.clearAll();\r\n    // });\r\n\r\n    describe('Check 1', function(){\r\n        it('should insert tree elements', function(){\r\n            cache.set('key1', 'value1')\r\n                .set('key2', 2)\r\n                .set(3, {value:1});\r\n            Assert.strictEqual(cache.size, 3);\r\n        });\r\n        it('Should returns 3', function(){\r\n            Assert.strictEqual(cache.get('key2'), 2);\r\n        });\r\n        it('Should returns \"value1\"', function(){\r\n            Assert.strictEqual(cache.get('key1'), 'value1');\r\n        });\r\n        it('Should returns obj', function(){\r\n            Assert.deepStrictEqual(cache.get(3), {value: 1});\r\n        });\r\n        // it('shoould remove items after 70 seconds', function(cb){\r\n        //     setTimeout(function(){\r\n        //         var error= null\r\n        //         try {\r\n        //             Assert.strictEqual(cache.size, 0);\r\n        //         } catch (err) {\r\n        //             error= err\r\n        //         }\r\n        //         cb(error);\r\n        //     }, 70000);\r\n        // });\r\n    });\r\n\r\n    describe('LRU', function(){\r\n        it('should keep last 4 elements only', function(){\r\n            cache.set('ky1', 'v');\r\n            cache.set('k2', 'v');\r\n            cache.set('ky3', 'v');\r\n            cache.set('ky4', 'v');\r\n            cache.set('ky5', 'v');\r\n            cache.set('ky6', 'v');\r\n            cache.set('ky7', 'v');\r\n            cache.set('ky8', 'v');\r\n            cache.set('ky9', 'v');\r\n            Assert.strictEqual(cache.size, cache.max);\r\n        });\r\n    });\r\n\r\n\tdescribe('TTL', function(){\r\n\t\tit('Should delete item after 4 seconds', function(cb:Function){\r\n\t\t\tthis.timeout(5000);\r\n\t\t\tvar cache= new LRU_TTL({ttl:3000});\r\n\t\t\tcache.set('k', 1);\r\n\t\t\tcache.set('k2', 2);\r\n\t\t\tcache.set('k3', 3);\r\n\t\t\tcache.setPermanent('k5', 'hello world')\r\n\t\t\tsetTimeout(function(){\r\n\t\t\t\tconsole.log('---k5>>', cache.get('k5'));\r\n\t\t\t\tconsole.log('--size: ', cache.size)\r\n\t\t\t\tcb(cache.tmpSize>0 ? new Error('Expected one element'): null)\r\n\t\t\t\t\r\n\t\t\t}, 4000)\r\n\t\t});\r\n\t})\r\n})"]}